{"ast":null,"code":"var _jsxFileName = \"/home/local/SUTRIXMEDIA1/vi.ha/Desktop/Demo/ReactJs/src/App.js\";\nimport React, { Component } from 'react';\nimport './App.css';\nimport { Route, Switch, Redirect, Router } from \"react-router-dom\";\nimport Login from './components/Login';\nimport Authors from './components/Authors'; // import {PrivateRoute} from './PrivateRoute';\n\nimport { createBrowserHistory } from 'history'; // import history from './history';\n\nimport axios from 'axios';\nimport { API_ENDPOINT } from './const';\nconst history = createBrowserHistory();\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n\n    this.checkValidToken = async () => {\n      var token = sessionStorage.getItem('token'); // console.log(token)\n\n      var isValid = false;\n\n      if (token) {\n        let url = API_ENDPOINT + 'api/token/verify/';\n        let options = {\n          method: 'POST',\n          url: url,\n          headers: {\n            'Accept': 'application/json',\n            'Content-Type': 'application/json'\n          },\n          data: {\n            \"token\": token\n          }\n        };\n        await axios({ ...options\n        }).then(res => {\n          if (res.status === 200) {\n            isValid = true;\n          }\n        }).catch(err => {\n          console.log(err);\n        });\n      }\n\n      return isValid;\n    };\n\n    this.componentDidMount = async () => {\n      var {\n        isLogin\n      } = this.state;\n      isLogin = await this.checkValidToken();\n\n      if (isLogin === true) {\n        await this.setState({\n          isLogin\n        });\n        history.push('/authors');\n      } else {\n        history.push('/login');\n      }\n    };\n\n    this.onLogin = async data => {\n      var {\n        username\n      } = data;\n      var {\n        password\n      } = data;\n      let url = API_ENDPOINT + 'login/';\n      let options = {\n        method: \"POST\",\n        url: url,\n        header: {\n          'Accept': 'application/json',\n          'Content-Type': 'application/json'\n        },\n        credentials: 'same-origin',\n        data: {\n          'username': username,\n          'password': password\n        }\n      };\n      await axios({ ...options\n      }).then(res => {\n        if (res.data) {\n          var data = res.data;\n          this.setState({\n            token: data.access,\n            isLogin: true\n          });\n          sessionStorage.setItem('token', this.state.token);\n          history.push('/authors');\n        }\n      }).catch(err => {\n        console.log(err);\n        return err.response;\n      });\n    };\n\n    this.onGetAuthors = async () => {\n      var token = sessionStorage.getItem('token');\n\n      if (token) {\n        let url = API_ENDPOINT + 'book/authors/';\n        console.log(url);\n        let options = {\n          method: \"GET\",\n          url: url,\n          header: {\n            \"Authorization\": \"Bearer \" + token,\n            'Accept': 'application/json',\n            'Content-Type': 'application/json'\n          }\n        };\n        await axios({ ...options\n        }).then(res => {\n          //  console.log(res)\n          if (res) {\n            var authorArr = res.data;\n            this.setState({\n              authors: authorArr\n            }); // console.log(this.state.author)\n          }\n        }).catch(err => {\n          console.log(err);\n        });\n      }\n    };\n\n    this.onCreateAuthor = data => {\n      console.log(data);\n      var token = sessionStorage.getItem('token');\n\n      if (token) {\n        if (data.id !== '') {\n          console.log(\"UPDATING AUTHOR IN APP \");\n          let {\n            firstname,\n            lastname,\n            email,\n            id\n          } = data;\n          let url = API_ENDPOINT + 'book/authors/' + id + '/';\n          let options = {\n            method: 'PATCH',\n            url: url,\n            header: {\n              'Authorization': 'Bearer ' + token,\n              'Content-Type': 'application/json'\n            },\n            data: {\n              'first_name': firstname,\n              'last_name': lastname,\n              'email': email\n            }\n          };\n          axios({ ...options\n          }).then(res => {\n            console.log(res);\n\n            if (res && res.status === 200) {\n              this.onGetAuthors();\n            }\n          }).catch(err => {\n            console.log(err);\n          });\n        } else {\n          console.log(\"CREATE NEW AUTHOR IN APP\");\n          let {\n            firstname,\n            lastname,\n            email\n          } = data;\n          let url = API_ENDPOINT + 'book/authors/';\n          let options = {\n            method: 'POST',\n            url: url,\n            header: {\n              'Authorization': 'Bearer ' + token,\n              'Content-Type': 'application/json'\n            },\n            data: {\n              'first_name': firstname,\n              'last_name': lastname,\n              'email': email\n            }\n          };\n          axios({ ...options\n          }).then(res => {\n            if (res && res.status === 201) {\n              this.onGetAuthors();\n            }\n          }).catch(err => {\n            console.log(err);\n          });\n        }\n      }\n    };\n\n    this.onDeleteAuthor = async data => {\n      // console.log(\"ON DELETE ID= \", data);\n      var token = sessionStorage.getItem('token');\n\n      if (token) {\n        var id = data;\n        var url = API_ENDPOINT + 'book/authors/' + id + \"/\";\n        var options = {\n          method: 'DELETE',\n          url: url,\n          header: {\n            'Authorization': 'Bearer ' + token,\n            'Content-Type': 'application/json'\n          },\n          credentials: \"same-origin\"\n        };\n        await axios({ ...options\n        }).then(res => {\n          if (res && res.status === 204) {\n            this.onGetAuthors();\n          }\n        }).catch(err => {\n          console.log(err);\n        });\n      }\n    };\n\n    this.onEditAuthor = data => {// console.log(\"ON EDIT ID= \", data);\n    };\n\n    this.state = {\n      token: '',\n      authors: [],\n      errorMessage: 'login fail'\n    };\n  }\n\n  renderErrorMesage() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 17\n      }\n    }, \"Login Fail\"));\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(Router, {\n      history: history,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 241,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Switch, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 242,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Route, {\n      exact: true,\n      path: \"/login\",\n      render: props => /*#__PURE__*/React.createElement(Login, {\n        onLogin: this.onLogin,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 247,\n          columnNumber: 29\n        }\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 243,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(Route, {\n      exact: true,\n      path: \"/authors\",\n      render: props => /*#__PURE__*/React.createElement(Authors, {\n        onGetAuthors: this.onGetAuthors,\n        authors: this.state.authors,\n        onCreateAuthor: this.onCreateAuthor,\n        onDeleteAuthor: this.onDeleteAuthor,\n        onEditAuthor: this.onEditAuthor,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 254,\n          columnNumber: 29\n        }\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(Redirect, {\n      to: \"/login\",\n      from: \"/\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 261,\n        columnNumber: 21\n      }\n    })));\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/home/local/SUTRIXMEDIA1/vi.ha/Desktop/Demo/ReactJs/src/App.js"],"names":["React","Component","Route","Switch","Redirect","Router","Login","Authors","createBrowserHistory","axios","API_ENDPOINT","history","App","constructor","props","checkValidToken","token","sessionStorage","getItem","isValid","url","options","method","headers","data","then","res","status","catch","err","console","log","componentDidMount","isLogin","state","setState","push","onLogin","username","password","header","credentials","access","setItem","response","onGetAuthors","authorArr","authors","onCreateAuthor","id","firstname","lastname","email","onDeleteAuthor","onEditAuthor","errorMessage","renderErrorMesage","render"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport './App.css';\nimport { Route, Switch, Redirect, Router } from \"react-router-dom\";\nimport Login from './components/Login';\nimport Authors from './components/Authors';\n// import {PrivateRoute} from './PrivateRoute';\nimport { createBrowserHistory } from 'history';\n// import history from './history';\nimport axios from 'axios';\nimport { API_ENDPOINT } from './const';\n\nconst history = createBrowserHistory();\n\nclass App extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            token: '',\n            authors: [],\n            errorMessage : 'login fail',\n        }\n    }\n\n\n    checkValidToken = async () => {\n        var token = sessionStorage.getItem('token');\n        // console.log(token)\n        var isValid = false;\n        if (token) {\n            let url = API_ENDPOINT + 'api/token/verify/';\n            let options = {\n                method: 'POST',\n                url: url,\n                headers: {\n                    'Accept': 'application/json',\n                    'Content-Type': 'application/json',\n                },\n                data: {\n                    \"token\": token\n                }\n            };\n\n            await axios({ ...options }).then((res) => {\n                if (res.status === 200) {\n                    isValid = true\n                }\n            }).catch((err) => {\n                console.log(err)\n            })\n        }\n\n        return isValid;\n    }\n\n    componentDidMount = async () => {\n        var { isLogin } = this.state;\n        isLogin = await this.checkValidToken()\n        if (isLogin === true) {\n            await this.setState({ isLogin })\n            history.push('/authors');\n        }\n        else {\n            history.push('/login')\n        }\n    }\n\n    renderErrorMesage () {\n        return (\n            <div>\n                <p>Login Fail</p>\n            </div>\n        )\n    }\n    \n\n    onLogin = async (data) => {\n        var { username } = data;\n        var { password } = data;\n        let url = API_ENDPOINT + 'login/';\n        let options = {\n            method: \"POST\",\n            url: url,\n            header: {\n                'Accept': 'application/json',\n                'Content-Type': 'application/json',\n            },\n            credentials: 'same-origin',\n            data: {\n                'username': username,\n                'password': password\n            }\n        };\n\n        await axios({ ...options }).then((res) => {\n            if (res.data) \n            {\n                var data = res.data\n                this.setState({\n                    token: data.access,\n                    isLogin: true\n                });\n\n                sessionStorage.setItem('token', this.state.token);\n                history.push('/authors')\n            }\n        }).catch((err) => {\n            console.log(err);          \n            return err.response;\n        })\n    }\n\n    \n\n    onGetAuthors = async () => {\n        var token = sessionStorage.getItem('token');\n        if (token) {\n            let url = API_ENDPOINT + 'book/authors/';\n            console.log(url)\n            let options = {\n                method: \"GET\",\n                url: url,\n                header: {\n                    \"Authorization\": \"Bearer \" + token,\n                    'Accept': 'application/json',\n                    'Content-Type': 'application/json',\n                },\n\n            }\n\n            await axios({ ...options }).then((res) => {\n                //  console.log(res)\n                if (res) {\n                    var authorArr = res.data;\n                    this.setState({\n                        authors: authorArr\n                    });\n                    // console.log(this.state.author)\n                }\n            }).catch((err) => {\n                console.log(err)\n            })\n\n\n        }\n    }\n\n    onCreateAuthor = (data) => {\n        console.log(data);\n        var token = sessionStorage.getItem('token');\n        if (token) {\n            if (data.id !== '') {\n                console.log(\"UPDATING AUTHOR IN APP \");\n                let {firstname, lastname, email, id} = data;\n                let url = API_ENDPOINT + 'book/authors/' + id + '/';\n                let options = {\n                    method: 'PATCH',\n                    url: url,\n                    header: {\n                        'Authorization': 'Bearer ' + token,\n                        'Content-Type': 'application/json'\n                    },\n                    data: {\n                        'first_name': firstname,\n                        'last_name': lastname,\n                        'email': email\n                    }\n                };\n\n                axios({...options}).then((res)=>{\n                    console.log(res)\n                    if(res && res.status === 200){\n                        this.onGetAuthors();\n                    }\n                }).catch((err)=>{\n                    console.log(err)\n                })\n            }\n            else {\n                console.log(\"CREATE NEW AUTHOR IN APP\")\n                let { firstname, lastname, email } = data;\n                let url = API_ENDPOINT + 'book/authors/';\n                let options = {\n                    method: 'POST',\n                    url: url,\n                    header: {\n                        'Authorization': 'Bearer ' + token,\n                        'Content-Type': 'application/json'\n                    },\n                    data: {\n                        'first_name': firstname,\n                        'last_name': lastname,\n                        'email': email\n                    }\n                };\n                axios({ ...options }).then((res) => {\n                    if (res && res.status === 201) {\n                        this.onGetAuthors();\n                    }\n                }).catch((err) => {\n                    console.log(err)\n                })\n\n            }\n        }\n\n    }\n\n    onDeleteAuthor = async (data) => {\n        // console.log(\"ON DELETE ID= \", data);\n        var token = sessionStorage.getItem('token');\n        if (token) {\n            var id = data;\n            var url = API_ENDPOINT + 'book/authors/' + id + \"/\";\n            var options = {\n                method: 'DELETE',\n                url: url,\n                header: {\n                    'Authorization': 'Bearer ' + token,\n                    'Content-Type': 'application/json'\n                },\n                credentials: \"same-origin\"\n            }\n            await axios({ ...options }).then((res) => {\n\n                if (res && res.status === 204) {\n                    this.onGetAuthors();\n                }\n            }).catch((err) => {\n                console.log(err)\n            })\n\n        }\n    }\n\n    onEditAuthor = (data) => {\n        // console.log(\"ON EDIT ID= \", data);\n    }\n\n    render() {\n        return (\n            <Router history={history}>\n                <Switch>\n                    <Route\n                        exact\n                        path=\"/login\"\n                        render={(props) => (\n                            <Login onLogin={this.onLogin} />\n                        )} />\n\n                    <Route\n                        exact\n                        path=\"/authors\"\n                        render={(props) => (\n                            <Authors\n                                onGetAuthors={this.onGetAuthors}\n                                authors={this.state.authors}\n                                onCreateAuthor={this.onCreateAuthor}\n                                onDeleteAuthor={this.onDeleteAuthor}\n                                onEditAuthor={this.onEditAuthor} />\n                        )} />\n                    <Redirect to=\"/login\" from=\"/\" />\n                </Switch>\n            </Router>\n\n        );\n    }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}